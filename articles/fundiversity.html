<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computing functional diversity indices with `fundiversity` • fundiversity</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Computing functional diversity indices with `fundiversity`">
<meta property="og:description" content="fundiversity">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fundiversity</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fundiversity.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/performance.html">Performance comparison with other functional diversity packages</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fundiversity_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Computing functional diversity indices with <code>fundiversity</code>
</h1>
            
      
      
      <div class="hidden name"><code>fundiversity.Rmd</code></div>

    </div>

    
    
<p><code>fundiversity</code> lets you compute functional diversity indices. Currently it can compute three indices:</p>
<ul>
<li>functional richness (FRic)</li>
<li>functional divergence (FDiv)</li>
<li>Rao’s quadratic entropy (Q)</li>
</ul>
<p>This vignette will introduce you to the data needed to compute the indices as well as the computation and interpretation of each index.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"fundiversity"</span><span class="op">)</span></code></pre></div>
<div id="the-required-data" class="section level1">
<h1 class="hasAnchor">
<a href="#the-required-data" class="anchor"></a>The required data</h1>
<p>To compute functional diversity indices, you will need at least a dataset describing species traits, i.e. species characteristics. Note that we here talk about species but the reasoning could apply on whatever unit you’re interested in whether it’s individual organisms, ecological plots, or even entire ecosystems. The traits are the features that describe these units.</p>
<p><code>fundiversity</code> comes with one example trait dataset. The dataset comes from <span class="citation">Nowak, Kissling, Bender, Dehling, Töpfer, Böhning-Gaese, et al. (2019)</span> and describe the traits of birds and plants along a tropical gradient <span class="citation">(Nowak, Kissling, Bender, Dehling, Töpfer, Böhning-Gaese, et al. 2019)</span>. You can see the datasets available in <code>fundiversity</code> using the <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"fundiversity"</span><span class="op">)</span></code></pre></div>
<p>To load them use their names into the <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"traits_birds"</span>, package <span class="op">=</span> <span class="st">"fundiversity"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>
<span class="co">#&gt;                      Bill.width..mm. Bill.length..mm. Kipp.s.index Bodymass..g.</span>
<span class="co">#&gt; Aburria_aburri                 18.35            35.48         0.18       1407.5</span>
<span class="co">#&gt; Amazona_farinosa               26.50            38.81         0.29        626.0</span>
<span class="co">#&gt; Amazona_mercenaria             17.51            26.30         0.33        340.0</span>
<span class="co">#&gt; Amazona_ochrocephala           20.17            31.40         0.26        440.0</span>
<span class="co">#&gt; Ampelioides_tschudii           16.53            24.58         0.24         78.4</span>
<span class="co">#&gt; Ampelion_rufaxilla             16.97            21.89         0.28         73.9</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"traits_plants"</span>, package <span class="op">=</span> <span class="st">"fundiversity"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">traits_plants</span><span class="op">)</span>
<span class="co">#&gt;                        Fruit.length..mm. Fruit.width..mm. Plant.height..m.</span>
<span class="co">#&gt; Abuta_grandifolia                  17.48             9.38             6.00</span>
<span class="co">#&gt; Alchornea_latifolia                 6.82             8.23            11.53</span>
<span class="co">#&gt; Alchornea_triplinervia              8.18            10.26            14.72</span>
<span class="co">#&gt; Allophylus_punctatus               13.58            12.49             4.40</span>
<span class="co">#&gt; Alnus_acuminata                    19.32            11.48            17.54</span>
<span class="co">#&gt; Aniba_guianensis                   15.65            13.43             8.00</span>
<span class="co">#&gt;                        Crop.mass..g.</span>
<span class="co">#&gt; Abuta_grandifolia             341.25</span>
<span class="co">#&gt; Alchornea_latifolia          1290.48</span>
<span class="co">#&gt; Alchornea_triplinervia       1156.67</span>
<span class="co">#&gt; Allophylus_punctatus           33.34</span>
<span class="co">#&gt; Alnus_acuminata              5009.33</span>
<span class="co">#&gt; Aniba_guianensis               25.50</span></code></pre></div>
<p>Note that in these datasets the species are shown in rows, with species names as row names, and traits are in columns.</p>
<p>Functional diversity indices are generally computed at different locations that we hereafter call sites. We thus need a description of which species is in which site in the form of a site-species matrix. Again, we’re calling it a site-species matrix but the granularity of both your “species” and “site” units can vary depending on what you want to compute functional diversity on.</p>
<p><code>fundiversity</code> contains the corresponding site-species matrices to the above-mentioned trait dataset <span class="citation">(Nowak, Kissling, Bender, Dehling, Töpfer, Böhning-Gaese, et al. 2019)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Site-species matrix for birds</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"site_sp_birds"</span>, package <span class="op">=</span> <span class="st">"fundiversity"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">site_sp_birds</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           Aburria_aburri Amazona_farinosa Amazona_mercenaria</span>
<span class="co">#&gt; elev_250               0                1                  0</span>
<span class="co">#&gt; elev_500               0                1                  0</span>
<span class="co">#&gt; elev_1000              1                1                  1</span>
<span class="co">#&gt; elev_1500              1                0                  1</span>
<span class="co">#&gt; elev_2000              0                0                  1</span>
<span class="co">#&gt;           Amazona_ochrocephala Ampelioides_tschudii</span>
<span class="co">#&gt; elev_250                     1                    0</span>
<span class="co">#&gt; elev_500                     1                    0</span>
<span class="co">#&gt; elev_1000                    0                    1</span>
<span class="co">#&gt; elev_1500                    0                    0</span>
<span class="co">#&gt; elev_2000                    0                    0</span>

<span class="co"># Site-species matrix for plants</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"site_sp_plants"</span>, package <span class="op">=</span> <span class="st">"fundiversity"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">site_sp_plants</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">5L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           Abuta_grandifolia Alchornea_latifolia Alchornea_triplinervia</span>
<span class="co">#&gt; elev_250                  1                   1                      1</span>
<span class="co">#&gt; elev_500                  1                   1                      1</span>
<span class="co">#&gt; elev_1000                 0                   0                      1</span>
<span class="co">#&gt; elev_1500                 0                   0                      1</span>
<span class="co">#&gt; elev_2000                 0                   0                      1</span>
<span class="co">#&gt;           Allophylus_punctatus Alnus_acuminata</span>
<span class="co">#&gt; elev_250                     1               1</span>
<span class="co">#&gt; elev_500                     1               1</span>
<span class="co">#&gt; elev_1000                    1               1</span>
<span class="co">#&gt; elev_1500                    1               1</span>
<span class="co">#&gt; elev_2000                    1               1</span></code></pre></div>
<p>The site species matrix represent the presence of a given species (in column) in a given site (in row), similar to the format used in the <a href="https://cran.r-project.org/package=vegan"><code>vegan</code></a> package. Here the site-species matrix contains only 0 (absence) and 1 (presence), but <code>fundiversity</code> can also use matrices that contain abundances for some functional diversity indices (FDiv and Q).</p>
<p>To ensure the good computation of functional diversity indices, at least some of species names (row names) in the trait data need to be in to the column names of the site species matrix:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fewer traits than species in the site-species matrix</span>
<span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">217</span>,<span class="op">]</span>, <span class="va">site_sp_birds</span><span class="op">)</span>
<span class="co">#&gt; Differing number of species between trait dataset and site-species matrix</span>
<span class="co">#&gt; Taking subset of species</span>
<span class="co">#&gt;        site       FRic</span>
<span class="co">#&gt; 1  elev_250 171543.730</span>
<span class="co">#&gt; 2  elev_500 185612.548</span>
<span class="co">#&gt; 3 elev_1000 109615.330</span>
<span class="co">#&gt; 4 elev_1500  63992.817</span>
<span class="co">#&gt; 5 elev_2000  20065.764</span>
<span class="co">#&gt; 6 elev_2500  18301.176</span>
<span class="co">#&gt; 7 elev_3000  17530.651</span>
<span class="co">#&gt; 8 elev_3500   3708.735</span>

<span class="co"># Fewer species in the site-species matrix than in the traits</span>
<span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span>, <span class="va">site_sp_birds</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Differing number of species between trait dataset and site-species matrix</span>
<span class="co">#&gt; Taking subset of species</span>
<span class="co">#&gt; Error in geometry::convhulln(traits[site_row &gt; 0, ], "FA"): Received error code 1 from qhull. Qhull error:</span>
<span class="co">#&gt; QH6214 qhull input error: not enough points(2) to construct initial simplex (need 5)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; While executing:  | qhull FA  Qt</span>
<span class="co">#&gt; Options selected for Qhull 2015.2.r 2016/01/18:</span>
<span class="co">#&gt;   run-id 1653269476  FArea-total  Qtriangulate  _pre-merge  _zero-centrum</span>

<span class="co"># No species in common between both dataset</span>
<span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>, <span class="va">site_sp_birds</span><span class="op">[</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Error: No species in common found between trait dataset and site-species matrix</span></code></pre></div>
</div>
<div id="computing-the-indices" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-the-indices" class="anchor"></a>Computing the indices</h1>
<div id="functional-richness-fric---fd_fric" class="section level2">
<h2 class="hasAnchor">
<a href="#functional-richness-fric---fd_fric" class="anchor"></a>Functional Richness (FRic) - <code>fd_fric()</code>
</h2>
<p>Functional Richness (FRic) represents the total amount of functional space filed by a community in a dataset <span class="citation">(Villéger, Mason, and Mouillot 2008)</span>. You can compute FRic in <code>fundiversity</code> using the <code><a href="../reference/fd_fric.html">fd_fric()</a></code> function.</p>
<p>For a single trait range FRic is the range of trait observed in the dataset:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Range of bill width in the birds dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">[</span>, <span class="st">"Bill.width..mm."</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 33.64</span>

<span class="co"># Computation with fundiversity::fd_ric.</span>
<span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>
<span class="co">#&gt;   site     FRic</span>
<span class="co">#&gt; 1   s1 230967.7</span></code></pre></div>
<p>The first column <code>site</code> describes the site on which FRic has been computed while the <code>FRic</code> column contains the computed FRic values. If no site-species matrix has been provided the site is named by default <code>s1</code>.</p>
<p>For multiple traits, FRic can be thought as a multi-dimensional range which is computed as the convex hull volume of the considered species <span class="citation">(Villéger, Mason, and Mouillot 2008)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>
<span class="co">#&gt;   site     FRic</span>
<span class="co">#&gt; 1   s1 230967.7</span></code></pre></div>
<p>If you provide only a trait dataset without specifying site-species matrix <code><a href="../reference/fd_fric.html">fd_fric()</a></code> computes FRic on the full trait dataset. You can compute FRic values for different sites by providing both a trait dataset and a site-species matrix to <code><a href="../reference/fd_fric.html">fd_fric()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span>, <span class="va">site_sp_birds</span><span class="op">)</span>
<span class="co">#&gt;        site       FRic</span>
<span class="co">#&gt; 1  elev_250 171543.730</span>
<span class="co">#&gt; 2  elev_500 185612.548</span>
<span class="co">#&gt; 3 elev_1000 112600.176</span>
<span class="co">#&gt; 4 elev_1500  66142.748</span>
<span class="co">#&gt; 5 elev_2000  20065.764</span>
<span class="co">#&gt; 6 elev_2500  18301.176</span>
<span class="co">#&gt; 7 elev_3000  17530.651</span>
<span class="co">#&gt; 8 elev_3500   3708.735</span></code></pre></div>
<p>Because the convex hull volume depends on the number and the units of the traits used, it is difficult to compare across datasets, that is why it has been suggested to standardize its value by the total volume comprising all species in the dataset <span class="citation">(Villéger, Mason, and Mouillot 2008)</span>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span>, stand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;   site FRic</span>
<span class="co">#&gt; 1   s1    1</span></code></pre></div>
<p>The newly computed FRic values will then be comprised between 0 and 1. It is especially useful when comparing different sites:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span>, <span class="va">site_sp_birds</span>, stand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;        site       FRic</span>
<span class="co">#&gt; 1  elev_250 0.74271733</span>
<span class="co">#&gt; 2  elev_500 0.80362981</span>
<span class="co">#&gt; 3 elev_1000 0.48751477</span>
<span class="co">#&gt; 4 elev_1500 0.28637225</span>
<span class="co">#&gt; 5 elev_2000 0.08687692</span>
<span class="co">#&gt; 6 elev_2500 0.07923694</span>
<span class="co">#&gt; 7 elev_3000 0.07590087</span>
<span class="co">#&gt; 8 elev_3500 0.01605737</span></code></pre></div>
<p>Each row gives the standardized FRic values of each site.</p>
</div>
<div id="functional-divergence-fdiv---fd_fdiv" class="section level2">
<h2 class="hasAnchor">
<a href="#functional-divergence-fdiv---fd_fdiv" class="anchor"></a>Functional Divergence (FDiv) - <code>fd_fdiv()</code>
</h2>
<p>Functional Divergence (FDiv) represents how abundance is spread along the different traits <span class="citation">(Villéger, Mason, and Mouillot 2008)</span>. When a species with extreme trait values has the highest abundance, then functional divergence is high.</p>
<p>Use the <code><a href="../reference/fd_fdiv.html">fd_fdiv()</a></code> function to compute functional divergence:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># One-dimension FDiv</span>
<span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">[</span>, <span class="fl">1</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;   site      FDiv</span>
<span class="co">#&gt; 1   s1 0.6344607</span>

<span class="co"># Multimple dimension FDiv</span>
<span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>
<span class="co">#&gt;   site      FDiv</span>
<span class="co">#&gt; 1   s1 0.6011971</span></code></pre></div>
<p>When no site-species matrix is provided, FDiv is computed by default considering all the species together. If you provide a site-species matrix, then FDiv is computed across all sites:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">traits_birds</span>, <span class="va">site_sp_birds</span><span class="op">)</span>
<span class="co">#&gt;        site      FDiv</span>
<span class="co">#&gt; 1  elev_250 0.6054795</span>
<span class="co">#&gt; 2  elev_500 0.6089524</span>
<span class="co">#&gt; 3 elev_1000 0.5920337</span>
<span class="co">#&gt; 4 elev_1500 0.6013418</span>
<span class="co">#&gt; 5 elev_2000 0.6231133</span>
<span class="co">#&gt; 6 elev_2500 0.6195107</span>
<span class="co">#&gt; 7 elev_3000 0.6197650</span>
<span class="co">#&gt; 8 elev_3500 0.6292052</span></code></pre></div>
<p>Similarly to FRic, if the included species differ between the site-species matrix and the trait dataset, <code><a href="../reference/fd_fdiv.html">fd_fdiv()</a></code> will take the common subset of species.</p>
</div>
<div id="raos-quadratic-entropy-q---fd_raoq" class="section level2">
<h2 class="hasAnchor">
<a href="#raos-quadratic-entropy-q---fd_raoq" class="anchor"></a>Rao’s Quadratic Entropy (Q) - <code>fd_raoq()</code>
</h2>
<p>Rao’s Quadratic entropy assesses the multi-dimensional divergence in trait space <span class="citation">(Rao 1982)</span>. It is the abundance-weighted variance of the trait dissimilarities between all species pairs.</p>
<p>You can compute Rao’s Quadratic entropy (Q) using the <code><a href="../reference/fd_raoq.html">fd_raoq()</a></code> function by providing a trait dataset:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>
<span class="co">#&gt;   site        Q</span>
<span class="co">#&gt; 1   s1 170.0519</span></code></pre></div>
<p>If you don’t provide a site-species matrix, <code><a href="../reference/fd_raoq.html">fd_raoq()</a></code> considers all species provided in the trait dataset present at equal abundances in the same site. You can also provide a site-species matrix to compute Q at different sites:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span><span class="va">traits_birds</span>, <span class="va">site_sp_birds</span><span class="op">)</span>
<span class="co">#&gt;        site         Q</span>
<span class="co">#&gt; 1  elev_250 194.78095</span>
<span class="co">#&gt; 2  elev_500 197.08184</span>
<span class="co">#&gt; 3 elev_1000 200.52231</span>
<span class="co">#&gt; 4 elev_1500 178.24801</span>
<span class="co">#&gt; 5 elev_2000  97.32416</span>
<span class="co">#&gt; 6 elev_2500 102.22461</span>
<span class="co">#&gt; 7 elev_3000 113.22049</span>
<span class="co">#&gt; 8 elev_3500  87.04750</span></code></pre></div>
<p>Because the computation of Rao’s quadratic entropy requires dissimilarities between all pair of species in the dataset, if you provide a trait dataset <code><a href="../reference/fd_raoq.html">fd_raoq()</a></code>, the function will compute the Euclidean distance between all pairs of species. If you wish to directly provide species dissimilarities, you can do so through the <code>dist_matrix</code> argument:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute dissimilarity between species with the Manhattan distance</span>
<span class="va">trait_dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">traits_birds</span>, method <span class="op">=</span> <span class="st">"manhattan"</span><span class="op">)</span>

<span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span>dist_matrix <span class="op">=</span> <span class="va">trait_dissim</span><span class="op">)</span>
<span class="co">#&gt;   site       Q</span>
<span class="co">#&gt; 1   s1 190.589</span>

<span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span>sp_com <span class="op">=</span> <span class="va">site_sp_birds</span>, dist_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">trait_dissim</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        site        Q</span>
<span class="co">#&gt; 1  elev_250 218.3636</span>
<span class="co">#&gt; 2  elev_500 220.8257</span>
<span class="co">#&gt; 3 elev_1000 220.0048</span>
<span class="co">#&gt; 4 elev_1500 196.6785</span>
<span class="co">#&gt; 5 elev_2000 112.6211</span>
<span class="co">#&gt; 6 elev_2500 117.6497</span>
<span class="co">#&gt; 7 elev_3000 127.5911</span>
<span class="co">#&gt; 8 elev_3500 104.8981</span></code></pre></div>
<p>NB: if you want to provide both a site-species matrix and a trait dissimilarity matrix please specify explicitly the arguments names.</p>
</div>
</div>
<div id="standardizing-your-trait-data" class="section level1">
<h1 class="hasAnchor">
<a href="#standardizing-your-trait-data" class="anchor"></a>Standardizing your trait data</h1>
<p><code>fundiversity</code> does not perform any transformation on the input trait or dissimilarity data. In <code><a href="../reference/fd_raoq.html">fd_raoq()</a></code> if you provide only continuous trait data then the function will attempt computing Euclidean distance between the species.</p>
<p>In order to get comparable functional diversity indices you can standardize the trait data. One option would be to consider the <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> function to scale each continuous trait with a mean of zero and a standard deviation of one (z-score). Each trait will then have the same importance when computing functional diversity indices:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">traits_birds_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">traits_birds_sc</span><span class="op">)</span>
<span class="co">#&gt;  Bill.width..mm.   Bill.length..mm.    Kipp.s.index      Bodymass..g.     </span>
<span class="co">#&gt;  Min.   :-1.1854   Min.   :-0.78608   Min.   :-1.8545   Min.   :-0.49301  </span>
<span class="co">#&gt;  1st Qu.:-0.7330   1st Qu.:-0.52857   1st Qu.:-0.7432   1st Qu.:-0.44701  </span>
<span class="co">#&gt;  Median :-0.2974   Median :-0.28257   Median :-0.2492   Median :-0.34440  </span>
<span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000  </span>
<span class="co">#&gt;  3rd Qu.: 0.4157   3rd Qu.: 0.09482   3rd Qu.: 0.3682   3rd Qu.:-0.03999  </span>
<span class="co">#&gt;  Max.   : 3.9738   Max.   : 7.20531   Max.   : 3.3317   Max.   : 5.79396</span>

<span class="co"># Unscaled</span>
<span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>
<span class="co">#&gt;   site     FRic</span>
<span class="co">#&gt; 1   s1 230967.7</span>

<span class="co"># Scaled</span>
<span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">traits_birds_sc</span><span class="op">)</span>
<span class="co">#&gt;   site    FRic</span>
<span class="co">#&gt; 1   s1 88.9286</span></code></pre></div>
<p>Another solution to make trait comparable is to scale them between 0 and 1 by scaling each trait by its maximum and minimum values:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">min_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>, <span class="va">min</span><span class="op">)</span><span class="op">)</span>
<span class="va">max_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">traits_birds</span><span class="op">)</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span>

<span class="va">traits_birds_minmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">traits_birds</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">min_values</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">max_values</span> <span class="op">-</span> <span class="va">min_values</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">traits_birds_minmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">traits_birds_minmax</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">traits_birds_minmax</span><span class="op">)</span>
<span class="co">#&gt;  Bill.width..mm.   Bill.length..mm.   Kipp.s.index     Bodymass..g.     </span>
<span class="co">#&gt;  Min.   :0.00000   Min.   :0.00000   Min.   :0.0000   Min.   :0.000000  </span>
<span class="co">#&gt;  1st Qu.:0.08769   1st Qu.:0.03222   1st Qu.:0.2143   1st Qu.:0.007317  </span>
<span class="co">#&gt;  Median :0.17212   Median :0.06301   Median :0.3095   Median :0.023637  </span>
<span class="co">#&gt;  Mean   :0.22977   Mean   :0.09837   Mean   :0.3576   Mean   :0.078418  </span>
<span class="co">#&gt;  3rd Qu.:0.31034   3rd Qu.:0.11023   3rd Qu.:0.4286   3rd Qu.:0.072057  </span>
<span class="co">#&gt;  Max.   :1.00000   Max.   :1.00000   Max.   :1.0000   Max.   :1.000000</span></code></pre></div>
<p>There are several other options available to standardize trait values, reviewed in <span class="citation">Leps et al. (2006)</span>.</p>
<p>If not all the traits you use are continuous, refer to the next section, which suggests ways of computing functional diversity indices with non-continuous traits.</p>
</div>
<div id="what-if-not-all-traits-are-continuous" class="section level1">
<h1 class="hasAnchor">
<a href="#what-if-not-all-traits-are-continuous" class="anchor"></a>What if not all traits are continuous?</h1>
<p>Do not panic. You can still compute the above-mentioned functional diversity indices. However, as all indices need continuous descriptors for all considered species. The general idea we present in this part is to go from the trait table to a table of quantitative descriptions by defining specific dissimilarity and projecting species dissimilarities onto quantitative space using Principal Coordinates Analysis (PCoA). The framework is fully described in <span class="citation">Maire et al. (2015)</span>.</p>
<p>To compute dissimilarity with non-continuous traits you can user Gower’s distance <span class="citation">(Gower 1971)</span> or its following adaptations <span class="citation">(Pavoine et al. 2009; Podani 1999)</span>. You can use the following functions: <code><a href="https://rdrr.io/pkg/cluster/man/daisy.html">cluster::daisy()</a></code>, <code><a href="https://rdrr.io/pkg/FD/man/gowdis.html">FD::gowdis()</a></code>, <code><a href="https://rdrr.io/pkg/ade4/man/dist.ktab.html">ade4::dist.ktab()</a></code>, or <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegan::vegdist()</a></code>.</p>
<p>Then you can project these dissimilarities with Principal Coordinates using <code><a href="https://rdrr.io/pkg/ape/man/pcoa.html">ape::pcoa()</a></code> for example. You can then select the first dimensions that explains the most variance and use theses as the input “traits” to compute functional diversity indices.</p>
</div>
<div id="what-if-some-traits-have-missing-values" class="section level1">
<h1 class="hasAnchor">
<a href="#what-if-some-traits-have-missing-values" class="anchor"></a>What if some traits have missing values?</h1>
<p>Sometimes, some of the trait values can be missing for some species in your dataset. Because <code>fundiversity</code> does not want to make assumptions without telling you, by default it <strong>drops</strong> the species data for which the trait is missing.</p>
<p>If you want to use data with missing values you can use dissimilarity metrics that accept missing trait values such as some of the methods specified in <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegan::vegdist()</a></code>.</p>
<p>Another solution, would be to impute the missing trait value to fill it. Many imputation methods exists and trait imputation is out of the scope of <code>fundiversity</code> but you can find some details on how to proceed with the review by <span class="citation">Penone et al. (2014)</span>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Gower_general_1971">
<p>Gower, John C. 1971. “A General Coefficient of Similarity and Some of Its Properties.” <em>Biometrics</em>, 857–71.</p>
</div>
<div id="ref-Leps_Quantifying_2006">
<p>Leps, Jan, Francesco Bello, Sandra Lavorel, and Sandra Berman. 2006. “Quantifying and Interpreting Functional Diversity of Natural Communities: Practical Considerations Matter.” <em>Preslia</em> 78 (November): 481–501.</p>
</div>
<div id="ref-Maire_How_2015">
<p>Maire, Eva, Gaël Grenouillet, Sébastien Brosse, and Sébastien Villéger. 2015. “How Many Dimensions Are Needed to Accurately Assess Functional Diversity? A Pragmatic Approach for Assessing the Quality of Functional Spaces.” <em>Global Ecology and Biogeography</em> 24 (6): 728–40. <a href="https://doi.org/10.1111/geb.12299">https://doi.org/10.1111/geb.12299</a>.</p>
</div>
<div id="ref-Nowak_Data_2019">
<p>Nowak, Larissa, W. Daniel Kissling, Irene M. A. Bender, D. Matthias Dehling, Till Töpfer, Katrin Böhning-Gaese, and Matthias Schleuning. 2019. “Data from: Projecting Consequences of Global Warming for the Functional Diversity of Fleshy-Fruited Plants and Frugivorous Birds Along a Tropical Elevational Gradient.” <em>Data Dryad Digital Repository</em>. <a href="https://doi.org/10.5061/DRYAD.C0N737B">https://doi.org/10.5061/DRYAD.C0N737B</a>.</p>
</div>
<div id="ref-Nowak_Projecting_2019">
<p>Nowak, Larissa, W. Daniel Kissling, Irene M. A. Bender, D. Matthias Dehling, Till Töpfer, Katrin Böhning-Gaese, and Matthias Schleuning. 2019. “Projecting Consequences of Global Warming for the Functional Diversity of Fleshy-Fruited Plants and Frugivorous Birds Along a Tropical Elevational Gradient.” Edited by Kenneth Feeley. <em>Diversity and Distributions</em> 25 (9): 1362–74. <a href="https://doi.org/10.1111/ddi.12946">https://doi.org/10.1111/ddi.12946</a>.</p>
</div>
<div id="ref-Pavoine_challenge_2009">
<p>Pavoine, Sandrine, Jeanne Vallet, Anne-Béatrice Dufour, Sophie Gachet, and Hervé Daniel. 2009. “On the Challenge of Treating Various Types of Variables: Application for Improving the Measurement of Functional Diversity.” <em>Oikos</em> 118 (3): 391–402. <a href="https://doi.org/10.1111/j.1600-0706.2008.16668.x">https://doi.org/10.1111/j.1600-0706.2008.16668.x</a>.</p>
</div>
<div id="ref-Penone_Imputation_2014">
<p>Penone, Caterina, Ana D. Davidson, Kevin T. Shoemaker, Moreno Di Marco, Carlo Rondinini, Thomas M. Brooks, Bruce E. Young, Catherine H. Graham, and Gabriel C. Costa. 2014. “Imputation of Missing Data in Life-History Trait Datasets: Which Approach Performs the Best?” <em>Methods in Ecology and Evolution</em> 5 (9): 961–70. <a href="https://doi.org/10.1111/2041-210X.12232">https://doi.org/10.1111/2041-210X.12232</a>.</p>
</div>
<div id="ref-Podani_Extending_1999">
<p>Podani, János. 1999. “Extending Gower’s General Coefficient of Similarity to Ordinal Characters.” <em>Taxon</em>, 331–40.</p>
</div>
<div id="ref-Rao_Diversity_1982">
<p>Rao, C. Radhakrishna. 1982. “Diversity and Dissimilarity Coefficients: A Unified Approach.” <em>Theoretical Population Biology</em> 21 (1): 24–43. <a href="https://doi.org/10.1016/0040-5809(82)90004-1">https://doi.org/10.1016/0040-5809(82)90004-1</a>.</p>
</div>
<div id="ref-Villeger_New_2008">
<p>Villéger, Sébastien, Norman W. H. Mason, and David Mouillot. 2008. “New Multidimensional Functional Diversity Indices for a Multifaceted Framework in Functional Ecology.” <em>Ecology</em> 89 (8): 2290–2301. <a href="https://doi.org/10.1890/07-1206.1">https://doi.org/10.1890/07-1206.1</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rekyt.github.io/">Matthias Grenié</a>, <a href="https://www.normalesup.org/~hgruson/">Hugo Gruson</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
